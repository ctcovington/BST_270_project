<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.168">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Christian Covington">

<title>BST 270: Individual Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="reproduction_files/libs/clipboard/clipboard.min.js"></script>
<script src="reproduction_files/libs/quarto-html/quarto.js"></script>
<script src="reproduction_files/libs/quarto-html/popper.min.js"></script>
<script src="reproduction_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="reproduction_files/libs/quarto-html/anchor.min.js"></script>
<link href="reproduction_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="reproduction_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="reproduction_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="reproduction_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="reproduction_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="reproduction_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="reproduction_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">BST 270: Individual Project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Christian Covington </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="choice-of-project-and-realizing-non-reproducibility" class="level2">
<h2 class="anchored" data-anchor-id="choice-of-project-and-realizing-non-reproducibility">Choice of project and realizing non-reproducibility</h2>
<p>My goal was to reproduce several tables/figures from FiveThirtyEight’s <a href="https://projects.fivethirtyeight.com/2022-world-cup-predictions/">2022 World Cup Predictions</a>. In particular, I planned to reproduce the team-level forecasts which are accessed via the <code>Standings</code> button, and a few of the match-level forecasts accessed via the <code>Matches</code> button.</p>
<p>However, I found out halfway through the project that the match-level forecasts are not actually reproducible (I’ll explain this more later), so I ended up creating a new figure which gives some of the same information but which is possible to create given the information to which I have access.</p>
</section>
<section id="packagedata-loading" class="level2">
<h2 class="anchored" data-anchor-id="packagedata-loading">Package/Data Loading</h2>
<p>We begin by loading necessary packages, which we handle by using <a href="https://cran.r-project.org/web/packages/pacman/index.html">pacman</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load relevant packages </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">'pacman'</span>)) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">'pacman'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="st">'data.table'</span>, <span class="st">'ggplot2'</span>, <span class="st">'RCurl'</span>, <span class="st">'tidyverse'</span>, <span class="st">'knitr'</span>, <span class="st">'kableExtra'</span>, <span class="st">'ggsci'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we load two data sets that we will need to reproduce the figures from the article; one containing match data and one containing forecast data. Both data sets can be found on the <a href="https://github.com/fivethirtyeight/data/tree/master/world-cup-2022">FiveThirtyEight Github page</a>.</p>
<blockquote class="blockquote">
<p>NOTE: We download both data sets directly from online in the code block below if they have not yet been downloaded. If they have already been downloaded, we instead load them from the local data directory.</p>
</blockquote>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set working directory (location of repository)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">'/Users/christiancovington/courses/winter_23/BST_270/BST_270_project'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load data </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">'./data/matches.csv'</span>)) {</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    matches <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">'./data/matches.csv'</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    matches <span class="ot">&lt;-</span> <span class="fu">fread</span>( <span class="fu">getURL</span>(<span class="st">'https://projects.fivethirtyeight.com/soccer-api/international/2022/wc_matches.csv'</span>) )</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fwrite</span>(matches, <span class="st">'./data/matches.csv'</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">'./data/forecasts.csv'</span>)) {</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    forecasts <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">'./data/forecasts.csv'</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    forecasts <span class="ot">&lt;-</span> <span class="fu">fread</span>( <span class="fu">getURL</span>(<span class="st">'https://projects.fivethirtyeight.com/soccer-api/international/2022/wc_forecasts.csv'</span>) )</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fwrite</span>(forecasts, <span class="st">'./data/forecasts.csv'</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="reproduction-team-level-forecast-table" class="level2">
<h2 class="anchored" data-anchor-id="reproduction-team-level-forecast-table">Reproduction: Team-level Forecast Table</h2>
<p>My first goal is to reproduce the team-level forecasts. FiveThirtyEight produced forecasts at eight different times before and during the tournament, which can be cycled through using the dropdown menu at the bottom of the page listed above. There’s a lot of structural redundancy here (basically, only the numbers in the table change from one time to another), so I will reproduce the table from the first time period, referred to on the webpage as “before tournament”.</p>
<section id="identify-relevant-data" class="level3">
<h3 class="anchored" data-anchor-id="identify-relevant-data">Identify relevant data</h3>
<p>First, I’ll subset to observations which correspond to the “before tournament” period. As far as I can tell, there is no documentation on how to do this (or documentation on the data more generally) from FiveThirtyEight, but it’s obvious enough that the elegantly named <code>ï»¿forecast_timestamp</code> variable corresponds to the time periods in question.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count and print unique values of forecast timestamp </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>n_unique_timestamps <span class="ot">&lt;-</span> <span class="fu">nrow</span>(<span class="fu">unique</span>(forecasts[, <span class="st">'ï»¿forecast_timestamp'</span>]))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'number of unique forecast timestamp values = {n_unique_timestamps}'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>number of unique forecast timestamp values = 8</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(forecasts[, <span class="st">'ï»¿forecast_timestamp'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     ï»¿forecast_timestamp
1: 2022-12-18 17:56:03 UTC
2: 2022-12-17 16:54:45 UTC
3: 2022-12-10 21:01:29 UTC
4: 2022-12-06 20:54:12 UTC
5: 2022-12-02 21:01:10 UTC
6: 2022-11-28 20:59:50 UTC
7: 2022-11-24 20:56:17 UTC
8: 2022-11-16 16:00:55 UTC</code></pre>
</div>
</div>
<p>Having identified the timestamp variable, we can now subset our data only to forecasts from the “before tournament” timestamp.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset to "before tournament" forecasts</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>bt_forecasts <span class="ot">&lt;-</span> forecasts[<span class="fu">get</span>(<span class="st">'ï»¿forecast_timestamp'</span>) <span class="sc">==</span> <span class="st">'2022-11-16 16:00:55 UTC'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="identify-relevant-variables" class="level3">
<h3 class="anchored" data-anchor-id="identify-relevant-variables">Identify relevant variables</h3>
<p>We now identify the relevant variables for the table. Again, there is no documentation for how the variables in the data map to entries in the table but it is (mostly) obvious from the variable names. The only columns in the original table whose corresponding variable names are not necessarily obvious are the <code>OFF.</code> and <code>DEF.</code>,which correspond to variables <code>global_o</code> and <code>global_d</code>, and <code>CHANCE OF FINISHING GROUP STAGE IN &lt;k&gt;TH PLACE</code>, which corresponds to the <code>group_&lt;k&gt;</code> variable.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># identify relevant columns and create data for table</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>relevant_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'team'</span>, <span class="st">'group'</span>, <span class="st">'spi'</span>, <span class="st">'global_o'</span>, <span class="st">'global_d'</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">'group_1'</span>, <span class="st">'group_2'</span>, <span class="st">'make_round_of_16'</span>, <span class="st">'make_quarters'</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">'make_semis'</span>, <span class="st">'make_final'</span>, <span class="st">'win_league'</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>table1_data <span class="ot">&lt;-</span> bt_forecasts[, ..relevant_cols]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(table1_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Team'</span>, <span class="st">'Group'</span>, <span class="st">'SPI'</span>, <span class="st">'OFF.'</span>, <span class="st">'DEF.'</span>, <span class="st">'1ST PLACE'</span>, <span class="st">'2ND PLACE'</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                           <span class="st">'MAKE ROUND OF 16'</span>, <span class="st">'MAKE QUARTERFINALS'</span>, <span class="st">'MAKE SEMIFINALS'</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                           <span class="st">'MAKE FINAL'</span>, <span class="st">'WIN WORLD CUP'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="reproduce-table" class="level3">
<h3 class="anchored" data-anchor-id="reproduce-table">Reproduce table</h3>
<p>Now we use the data set we just created to reproduce the FiveThirtyEight table (modulo some minor style differences).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>faithful_table1_data <span class="ot">&lt;-</span> <span class="fu">copy</span>(table1_data)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># reformat columns which are numeric but not presented as percentages </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>nonpercentage_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'SPI'</span>, <span class="st">'OFF.'</span>, <span class="st">'DEF.'</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (nonpercentage_col <span class="cf">in</span> nonpercentage_cols) {</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    new_col <span class="ot">&lt;-</span> <span class="fu">round</span>(faithful_table1_data[, <span class="fu">get</span>(nonpercentage_col)], <span class="dv">1</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    faithful_table1_data[, <span class="fu">eval</span>(nonpercentage_col) <span class="sc">:</span><span class="er">=</span> new_col]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># reformat columns which are ultimately presented as percentages </span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>percentage_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'1ST PLACE'</span>, <span class="st">'2ND PLACE'</span>, <span class="st">'MAKE ROUND OF 16'</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'MAKE QUARTERFINALS'</span>, <span class="st">'MAKE SEMIFINALS'</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'MAKE FINAL'</span>, <span class="st">'WIN WORLD CUP'</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (percentage_col <span class="cf">in</span> percentage_cols) {</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    rounded_percentage <span class="ot">&lt;-</span> <span class="fu">as.character</span>( <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>faithful_table1_data[, <span class="fu">get</span>(percentage_col)], <span class="dv">0</span>))</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    new_col <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{rounded_percentage}%'</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    faithful_table1_data[, <span class="fu">eval</span>(percentage_col) <span class="sc">:</span><span class="er">=</span> new_col]</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co"># create more faithful table</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(faithful_table1_data) <span class="sc">%&gt;%</span> </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">' '</span> <span class="ot">=</span> <span class="dv">2</span>, </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'TEAM RATING'</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'CHANCE OF FINISHING GROUP STAGE IN ...'</span> <span class="ot">=</span> <span class="dv">2</span>, </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'KNOCKOUT STAGE CHANCES'</span> <span class="ot">=</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">spec_color</span>(table1_data<span class="sc">$</span><span class="st">`</span><span class="at">OFF.</span><span class="st">`</span>, <span class="at">end =</span> <span class="fl">0.7</span>)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">%&gt;%</span> </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="dv">5</span>, <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">spec_color</span>(table1_data<span class="sc">$</span><span class="st">`</span><span class="at">DEF.</span><span class="st">`</span>, <span class="at">end =</span> <span class="fl">0.7</span>)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">%&gt;%</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="dv">8</span>, <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">spec_color</span>(table1_data<span class="sc">$</span><span class="st">`</span><span class="at">MAKE ROUND OF 16</span><span class="st">`</span>, <span class="at">end =</span> <span class="fl">0.7</span>)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">%&gt;%</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="dv">9</span>, <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">spec_color</span>(table1_data<span class="sc">$</span><span class="st">`</span><span class="at">MAKE QUARTERFINALS</span><span class="st">`</span>, <span class="at">end =</span> <span class="fl">0.7</span>)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">%&gt;%</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="dv">10</span>, <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">spec_color</span>(table1_data<span class="sc">$</span><span class="st">`</span><span class="at">MAKE SEMIFINALS</span><span class="st">`</span>, <span class="at">end =</span> <span class="fl">0.7</span>)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">%&gt;%</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="dv">11</span>, <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">spec_color</span>(table1_data<span class="sc">$</span><span class="st">`</span><span class="at">MAKE FINAL</span><span class="st">`</span>, <span class="at">end =</span> <span class="fl">0.7</span>)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">%&gt;%</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_spec</span>(<span class="dv">12</span>, <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">spec_color</span>(table1_data<span class="sc">$</span><span class="st">`</span><span class="at">WIN WORLD CUP</span><span class="st">`</span>, <span class="at">end =</span> <span class="fl">0.7</span>)</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>              )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table" style="font-size: 10px; margin-left: auto; margin-right: auto;">
 <thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2"></th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">TEAM RATING</div></th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">CHANCE OF FINISHING GROUP STAGE IN ...</div></th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">KNOCKOUT STAGE CHANCES</div></th>
</tr>
  <tr>
   <th style="text-align:left;"> Team </th>
   <th style="text-align:left;"> Group </th>
   <th style="text-align:right;"> SPI </th>
   <th style="text-align:right;"> OFF. </th>
   <th style="text-align:right;"> DEF. </th>
   <th style="text-align:left;"> 1ST PLACE </th>
   <th style="text-align:left;"> 2ND PLACE </th>
   <th style="text-align:left;"> MAKE ROUND OF 16 </th>
   <th style="text-align:left;"> MAKE QUARTERFINALS </th>
   <th style="text-align:left;"> MAKE SEMIFINALS </th>
   <th style="text-align:left;"> MAKE FINAL </th>
   <th style="text-align:left;"> WIN WORLD CUP </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Brazil </td>
   <td style="text-align:left;"> G </td>
   <td style="text-align:right;"> 93.5 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(67, 191, 113, 1) !important;"> 3.2 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 1) !important;"> 0.3 </td>
   <td style="text-align:left;"> 72% </td>
   <td style="text-align:left;"> 19% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(67, 191, 113, 1) !important;"> 91% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(67, 191, 113, 1) !important;"> 69% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(67, 191, 113, 1) !important;"> 46% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(67, 191, 113, 1) !important;"> 32% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(67, 191, 113, 1) !important;"> 22% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Spain </td>
   <td style="text-align:left;"> E </td>
   <td style="text-align:right;"> 89.5 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(31, 153, 138, 1) !important;"> 2.8 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(72, 23, 105, 1) !important;"> 0.4 </td>
   <td style="text-align:left;"> 47% </td>
   <td style="text-align:left;"> 34% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(37, 171, 130, 1) !important;"> 81% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(31, 159, 136, 1) !important;"> 56% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(37, 132, 142, 1) !important;"> 30% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(41, 122, 142, 1) !important;"> 19% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(48, 107, 142, 1) !important;"> 11% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> France </td>
   <td style="text-align:left;"> D </td>
   <td style="text-align:right;"> 87.7 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(31, 150, 139, 1) !important;"> 2.8 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(71, 45, 123, 1) !important;"> 0.5 </td>
   <td style="text-align:left;"> 55% </td>
   <td style="text-align:left;"> 27% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(40, 174, 128, 1) !important;"> 83% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(30, 155, 138, 1) !important;"> 54% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(33, 144, 141, 1) !important;"> 33% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(45, 113, 142, 1) !important;"> 17% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(55, 91, 141, 1) !important;"> 9% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Argentina </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:right;"> 87.2 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(35, 137, 142, 1) !important;"> 2.6 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(72, 35, 116, 1) !important;"> 0.4 </td>
   <td style="text-align:left;"> 60% </td>
   <td style="text-align:left;"> 24% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(44, 177, 126, 1) !important;"> 84% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(31, 153, 139, 1) !important;"> 53% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(33, 142, 141, 1) !important;"> 33% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(48, 107, 142, 1) !important;"> 16% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(56, 89, 140, 1) !important;"> 8% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Portugal </td>
   <td style="text-align:left;"> H </td>
   <td style="text-align:right;"> 87.8 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(31, 152, 139, 1) !important;"> 2.8 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(71, 46, 124, 1) !important;"> 0.5 </td>
   <td style="text-align:left;"> 53% </td>
   <td style="text-align:left;"> 28% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(37, 172, 130, 1) !important;"> 81% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(37, 133, 142, 1) !important;"> 46% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(43, 117, 142, 1) !important;"> 26% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(49, 102, 142, 1) !important;"> 15% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(59, 81, 139, 1) !important;"> 8% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Germany </td>
   <td style="text-align:left;"> E </td>
   <td style="text-align:right;"> 88.8 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(59, 187, 117, 1) !important;"> 3.2 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(62, 74, 137, 1) !important;"> 0.6 </td>
   <td style="text-align:left;"> 40% </td>
   <td style="text-align:left;"> 36% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(31, 162, 135, 1) !important;"> 76% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(33, 144, 141, 1) !important;"> 50% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(45, 113, 142, 1) !important;"> 25% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(52, 97, 141, 1) !important;"> 14% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(60, 79, 138, 1) !important;"> 7% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> England </td>
   <td style="text-align:left;"> B </td>
   <td style="text-align:right;"> 86.0 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(38, 130, 142, 1) !important;"> 2.6 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(72, 41, 121, 1) !important;"> 0.5 </td>
   <td style="text-align:left;"> 55% </td>
   <td style="text-align:left;"> 25% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(36, 170, 131, 1) !important;"> 80% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(31, 148, 140, 1) !important;"> 52% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(38, 129, 142, 1) !important;"> 29% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(51, 100, 141, 1) !important;"> 15% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(61, 77, 138, 1) !important;"> 7% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Netherlands </td>
   <td style="text-align:left;"> A </td>
   <td style="text-align:right;"> 86.0 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(31, 153, 139, 1) !important;"> 2.8 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(65, 68, 135, 1) !important;"> 0.6 </td>
   <td style="text-align:left;"> 53% </td>
   <td style="text-align:left;"> 26% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(34, 168, 132, 1) !important;"> 79% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(33, 142, 141, 1) !important;"> 49% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(42, 120, 142, 1) !important;"> 27% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(58, 83, 139, 1) !important;"> 12% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(66, 65, 134, 1) !important;"> 6% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Denmark </td>
   <td style="text-align:left;"> D </td>
   <td style="text-align:right;"> 80.0 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(48, 107, 142, 1) !important;"> 2.3 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(64, 70, 136, 1) !important;"> 0.6 </td>
   <td style="text-align:left;"> 29% </td>
   <td style="text-align:left;"> 36% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(34, 139, 141, 1) !important;"> 65% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(49, 102, 142, 1) !important;"> 33% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(59, 82, 139, 1) !important;"> 17% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 51, 127, 1) !important;"> 7% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 33, 115, 1) !important;"> 3% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Uruguay </td>
   <td style="text-align:left;"> H </td>
   <td style="text-align:right;"> 80.9 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(49, 103, 142, 1) !important;"> 2.3 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(68, 58, 131, 1) !important;"> 0.5 </td>
   <td style="text-align:left;"> 30% </td>
   <td style="text-align:left;"> 35% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(34, 140, 141, 1) !important;"> 65% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(56, 88, 140, 1) !important;"> 28% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(65, 66, 135, 1) !important;"> 13% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 49, 126, 1) !important;"> 7% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 33, 115, 1) !important;"> 3% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Belgium </td>
   <td style="text-align:left;"> F </td>
   <td style="text-align:right;"> 82.5 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(35, 137, 142, 1) !important;"> 2.6 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(57, 86, 140, 1) !important;"> 0.7 </td>
   <td style="text-align:left;"> 36% </td>
   <td style="text-align:left;"> 27% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(36, 134, 142, 1) !important;"> 62% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(57, 85, 140, 1) !important;"> 27% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(67, 61, 132, 1) !important;"> 12% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 46, 124, 1) !important;"> 6% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 31, 112, 1) !important;"> 3% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Croatia </td>
   <td style="text-align:left;"> F </td>
   <td style="text-align:right;"> 78.8 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(48, 106, 142, 1) !important;"> 2.3 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(59, 81, 139, 1) !important;"> 0.7 </td>
   <td style="text-align:left;"> 28% </td>
   <td style="text-align:left;"> 27% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(43, 117, 142, 1) !important;"> 54% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(65, 68, 135, 1) !important;"> 21% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 45, 123, 1) !important;"> 9% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 32, 114, 1) !important;"> 4% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 22, 104, 1) !important;"> 2% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Switzerland </td>
   <td style="text-align:left;"> G </td>
   <td style="text-align:right;"> 77.6 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(50, 100, 142, 1) !important;"> 2.2 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(58, 85, 140, 1) !important;"> 0.7 </td>
   <td style="text-align:left;"> 13% </td>
   <td style="text-align:left;"> 34% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(49, 104, 142, 1) !important;"> 48% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(65, 66, 135, 1) !important;"> 21% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 46, 124, 1) !important;"> 9% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 31, 112, 1) !important;"> 4% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 19, 101, 1) !important;"> 1% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> USA </td>
   <td style="text-align:left;"> B </td>
   <td style="text-align:right;"> 74.8 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(56, 89, 140, 1) !important;"> 2.1 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(53, 94, 141, 1) !important;"> 0.7 </td>
   <td style="text-align:left;"> 22% </td>
   <td style="text-align:left;"> 31% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(44, 114, 142, 1) !important;"> 53% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(61, 77, 138, 1) !important;"> 24% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 51, 127, 1) !important;"> 10% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 28, 110, 1) !important;"> 4% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 16, 100, 1) !important;"> 1% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Mexico </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:right;"> 74.3 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(61, 77, 138, 1) !important;"> 2.0 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(58, 84, 140, 1) !important;"> 0.7 </td>
   <td style="text-align:left;"> 21% </td>
   <td style="text-align:left;"> 33% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(43, 116, 142, 1) !important;"> 54% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(64, 70, 136, 1) !important;"> 22% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 51, 126, 1) !important;"> 10% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 27, 109, 1) !important;"> 3% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 16, 100, 1) !important;"> 1% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Senegal </td>
   <td style="text-align:left;"> A </td>
   <td style="text-align:right;"> 73.8 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(63, 71, 136, 1) !important;"> 1.9 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(60, 80, 139, 1) !important;"> 0.6 </td>
   <td style="text-align:left;"> 21% </td>
   <td style="text-align:left;"> 30% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(46, 111, 142, 1) !important;"> 51% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(62, 73, 137, 1) !important;"> 23% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 48, 126, 1) !important;"> 10% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 27, 109, 1) !important;"> 3% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 16, 99, 1) !important;"> 1% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Ecuador </td>
   <td style="text-align:left;"> A </td>
   <td style="text-align:right;"> 72.7 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(63, 72, 137, 1) !important;"> 2.0 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(55, 90, 140, 1) !important;"> 0.7 </td>
   <td style="text-align:left;"> 19% </td>
   <td style="text-align:left;"> 29% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(48, 105, 142, 1) !important;"> 48% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(65, 66, 135, 1) !important;"> 21% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 44, 122, 1) !important;"> 8% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 23, 105, 1) !important;"> 3% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 13, 96, 1) !important;"> 1% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Morocco </td>
   <td style="text-align:left;"> F </td>
   <td style="text-align:right;"> 75.6 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(56, 87, 140, 1) !important;"> 2.1 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(57, 85, 140, 1) !important;"> 0.7 </td>
   <td style="text-align:left;"> 21% </td>
   <td style="text-align:left;"> 25% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(50, 101, 142, 1) !important;"> 46% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 52, 129, 1) !important;"> 17% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 32, 113, 1) !important;"> 6% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 22, 104, 1) !important;"> 3% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 13, 96, 1) !important;"> 1% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Serbia </td>
   <td style="text-align:left;"> G </td>
   <td style="text-align:right;"> 75.8 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(51, 100, 141, 1) !important;"> 2.2 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(51, 98, 141, 1) !important;"> 0.7 </td>
   <td style="text-align:left;"> 11% </td>
   <td style="text-align:left;"> 30% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(55, 90, 140, 1) !important;"> 41% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 52, 129, 1) !important;"> 17% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 35, 116, 1) !important;"> 7% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 23, 105, 1) !important;"> 3% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 12, 95, 1) !important;"> 1% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Japan </td>
   <td style="text-align:left;"> E </td>
   <td style="text-align:right;"> 71.4 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(62, 75, 137, 1) !important;"> 2.0 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(49, 104, 142, 1) !important;"> 0.8 </td>
   <td style="text-align:left;"> 11% </td>
   <td style="text-align:left;"> 23% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(62, 74, 137, 1) !important;"> 34% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 51, 126, 1) !important;"> 16% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 30, 111, 1) !important;"> 6% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 20, 102, 1) !important;"> 2% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 11, 94, 1) !important;"> 1% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Canada </td>
   <td style="text-align:left;"> F </td>
   <td style="text-align:right;"> 71.6 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(63, 71, 136, 1) !important;"> 1.9 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(52, 97, 141, 1) !important;"> 0.7 </td>
   <td style="text-align:left;"> 15% </td>
   <td style="text-align:left;"> 21% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(60, 79, 138, 1) !important;"> 37% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 36, 116, 1) !important;"> 11% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 21, 103, 1) !important;"> 4% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 13, 96, 1) !important;"> 2% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 7, 90, 1) !important;"> 1% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Poland </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:right;"> 68.3 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(66, 63, 133, 1) !important;"> 1.9 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(45, 113, 142, 1) !important;"> 0.8 </td>
   <td style="text-align:left;"> 13% </td>
   <td style="text-align:left;"> 25% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(59, 82, 139, 1) !important;"> 38% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 41, 121, 1) !important;"> 13% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 27, 109, 1) !important;"> 5% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 12, 95, 1) !important;"> 1% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(69, 6, 90, 1) !important;"> 0% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> South Korea </td>
   <td style="text-align:left;"> H </td>
   <td style="text-align:right;"> 66.1 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(71, 46, 124, 1) !important;"> 1.7 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(46, 109, 142, 1) !important;"> 0.8 </td>
   <td style="text-align:left;"> 12% </td>
   <td style="text-align:left;"> 24% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(61, 77, 138, 1) !important;"> 36% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 32, 114, 1) !important;"> 11% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 20, 102, 1) !important;"> 4% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 11, 94, 1) !important;"> 1% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(69, 6, 90, 1) !important;"> 0% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Tunisia </td>
   <td style="text-align:left;"> D </td>
   <td style="text-align:right;"> 65.9 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(72, 33, 115, 1) !important;"> 1.6 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(52, 97, 141, 1) !important;"> 0.7 </td>
   <td style="text-align:left;"> 10% </td>
   <td style="text-align:left;"> 21% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(66, 64, 134, 1) !important;"> 31% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 35, 116, 1) !important;"> 11% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 22, 104, 1) !important;"> 4% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 9, 93, 1) !important;"> 1% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(69, 5, 89, 1) !important;"> 0% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Iran </td>
   <td style="text-align:left;"> B </td>
   <td style="text-align:right;"> 62.2 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(71, 17, 100, 1) !important;"> 1.5 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(49, 104, 142, 1) !important;"> 0.8 </td>
   <td style="text-align:left;"> 12% </td>
   <td style="text-align:left;"> 23% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(62, 73, 137, 1) !important;"> 34% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 40, 120, 1) !important;"> 13% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 23, 105, 1) !important;"> 4% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 10, 93, 1) !important;"> 1% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(69, 5, 89, 1) !important;"> 0% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Wales </td>
   <td style="text-align:left;"> B </td>
   <td style="text-align:right;"> 65.6 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(71, 44, 122, 1) !important;"> 1.7 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(46, 110, 142, 1) !important;"> 0.8 </td>
   <td style="text-align:left;"> 11% </td>
   <td style="text-align:left;"> 22% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(64, 69, 136, 1) !important;"> 32% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 36, 117, 1) !important;"> 12% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 21, 103, 1) !important;"> 4% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 9, 93, 1) !important;"> 1% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(69, 5, 89, 1) !important;"> 0% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Cameroon </td>
   <td style="text-align:left;"> G </td>
   <td style="text-align:right;"> 64.2 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(72, 36, 117, 1) !important;"> 1.7 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(45, 112, 142, 1) !important;"> 0.8 </td>
   <td style="text-align:left;"> 4% </td>
   <td style="text-align:left;"> 16% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 36, 116, 1) !important;"> 20% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 14, 97, 1) !important;"> 6% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 8, 92, 1) !important;"> 2% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(69, 5, 89, 1) !important;"> 1% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(68, 3, 86, 1) !important;"> 0% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Saudi Arabia </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:right;"> 56.9 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(71, 16, 99, 1) !important;"> 1.5 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(34, 139, 141, 1) !important;"> 1.0 </td>
   <td style="text-align:left;"> 7% </td>
   <td style="text-align:left;"> 17% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 48, 126, 1) !important;"> 24% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 20, 102, 1) !important;"> 7% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 10, 93, 1) !important;"> 2% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(69, 4, 87, 1) !important;"> 1% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(68, 1, 86, 1) !important;"> 0% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Australia </td>
   <td style="text-align:left;"> D </td>
   <td style="text-align:right;"> 60.8 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(72, 28, 110, 1) !important;"> 1.6 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(39, 126, 142, 1) !important;"> 0.9 </td>
   <td style="text-align:left;"> 6% </td>
   <td style="text-align:left;"> 16% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 41, 121, 1) !important;"> 22% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 17, 100, 1) !important;"> 6% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 10, 93, 1) !important;"> 2% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(69, 4, 87, 1) !important;"> 0% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(68, 1, 86, 1) !important;"> 0% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Qatar </td>
   <td style="text-align:left;"> A </td>
   <td style="text-align:right;"> 51.0 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(72, 26, 108, 1) !important;"> 1.6 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(67, 191, 113, 1) !important;"> 1.3 </td>
   <td style="text-align:left;"> 7% </td>
   <td style="text-align:left;"> 15% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 41, 121, 1) !important;"> 22% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(71, 17, 100, 1) !important;"> 7% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(70, 8, 92, 1) !important;"> 2% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(68, 3, 86, 1) !important;"> 0% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(68, 1, 86, 1) !important;"> 0% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Ghana </td>
   <td style="text-align:left;"> H </td>
   <td style="text-align:right;"> 58.6 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(69, 6, 90, 1) !important;"> 1.4 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(43, 116, 142, 1) !important;"> 0.9 </td>
   <td style="text-align:left;"> 5% </td>
   <td style="text-align:left;"> 13% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(72, 31, 112, 1) !important;"> 18% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(69, 6, 90, 1) !important;"> 4% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(68, 3, 86, 1) !important;"> 1% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(68, 1, 86, 1) !important;"> 0% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(68, 1, 84, 1) !important;"> 0% </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Costa Rica </td>
   <td style="text-align:left;"> E </td>
   <td style="text-align:right;"> 55.5 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 1) !important;"> 1.4 </td>
   <td style="text-align:right;color: white !important;background-color: rgba(37, 132, 142, 1) !important;"> 1.0 </td>
   <td style="text-align:left;"> 2% </td>
   <td style="text-align:left;"> 7% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(68, 1, 84, 1) !important;"> 8% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(68, 1, 84, 1) !important;"> 2% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(68, 1, 84, 1) !important;"> 1% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(68, 1, 84, 1) !important;"> 0% </td>
   <td style="text-align:left;color: white !important;background-color: rgba(68, 1, 84, 1) !important;"> 0% </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
</section>
<section id="reproduction-match-level-forecast-table" class="level2">
<h2 class="anchored" data-anchor-id="reproduction-match-level-forecast-table">Reproduction: Match-level Forecast Table</h2>
<p>We now move on to the match-level forecasts. For each World Cup match, FiveThirtyEight gave real-time forecasts showing each team’s chance of winning, losing, or drawing (for group-stage matches in which a draw was possible). These forecasts were updated periodically throughout each match in response to match events, eventually culminating in a forecast matching the true outcome of the match. Because reproducing all 64 forecast plots (one for each match), would be quite onerous, I planned to reproduce just two of the plots; one from the group stage (where draws are possible) and one from the knockout round (where draws are not possible).</p>
<section id="identifying-relevant-data" class="level3">
<h3 class="anchored" data-anchor-id="identifying-relevant-data">Identifying relevant data</h3>
<p>This is where my reproduction attempt hit an issue. Above, I mentioned that FiveThirtyEight’s forecasts updated periodically throughout each match – thus, their figures reflect real-time changes to their forecast during each match. However, these within-match changes to the forecast are not reflected in the data, as we can see by examining the data corresponding to the first match of the World Cup.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># examine data corresponding to first match</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( matches[date <span class="sc">==</span> <span class="st">'2022-11-20'</span>] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         date league_id         league team1   team2 spi1  spi2  prob1  prob2
1: 2022-11-20      1908 FIFA World Cup Qatar Ecuador   51 72.74 0.2369 0.5045
   probtie proj_score1 proj_score2 score1 score2  xg1  xg2 nsxg1 nsxg2
1:  0.2586        1.13        1.75      0      2 0.23 1.14  0.24  1.35
   adj_score1 adj_score2
1:          0        2.1</code></pre>
</div>
</div>
<p>We see that there are initial probabilities that team 1 wins (<code>prob1</code>), team 2 wins (<code>prob2</code>), and draw (<code>probtie</code>), as well as the eventual score (<code>score1</code> and <code>score2</code>) from which we can get the end-of-game “forecast” that reflects ground truth. However, there is no information about the changing within-game forecast. So, we cannot reproduce the figures that they provide.</p>
</section>
</section>
<section id="forecast-examination" class="level2">
<h2 class="anchored" data-anchor-id="forecast-examination">Forecast examination</h2>
<p>Instead, I’ll make a few different figures. First, I was interested to examine FiveThirtyEight’s forecasts on a few dimensions.</p>
<p>Below is a plot giving a rough sense for how well the predictions matched the eventual outcomes of each match. The x-axis is <code>Team 1 SPI - Team 2 SPI</code>, where <code>SPI</code> is a metric of team quality where teams that are believed to be better have higher <code>SPI</code>. The y-axis is an “adjusted probability” of Team 1 win, where this probability is given by <code>Pr(Team 1 win) + 0.5*Pr(Draw)</code>. I chose to give this adjusted probability in order to make the predictions more consistent between the matches where draws are possible and those where they are not. Finally, the points are colored by the actual result of the match. If FiveThirtyEight’s algorithm were highly accurate on this sample, we would see the <code>Win</code> dots at the top of the plot, <code>Draw</code> in the middle, and <code>Loss</code> at the bottom.</p>
<p>Note that these data do not actually include information about the final result for some of the knockout matches. This is because the only information included about the outcome of the match is the score for each team. We can uncover this by looking at the data for the final match, which was tied at the end of regulation and extra time and instead went to penalty kicks, where Argentina eventually won. However, there is nothing in the data showing the Argentina won the match.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># examine world cup final to show lack of outcome information</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(matches[date <span class="sc">==</span> <span class="st">'2022-12-18'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         date league_id         league     team1  team2  spi1  spi2  prob1
1: 2022-12-18      1908 FIFA World Cup Argentina France 88.86 88.41 0.5321
    prob2 probtie proj_score1 proj_score2 score1 score2  xg1  xg2 nsxg1 nsxg2
1: 0.4679       0         1.3        1.18      3      3 2.81 2.25  2.36  0.76
   adj_score1 adj_score2
1:       3.15       3.15</code></pre>
</div>
</div>
<p>This lack of ability to reliably get actual match results, without the use of outside knowledge, will affect our results for the rest of the analysis. In particular, we know that the result of every knockout stage match which ended regular and extra time in a draw (and thus subsequently was decided by a penalty shootout) will be coded as a <code>Draw</code> in our data, even though this is structurally impossible.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create new variables for SPI difference and adjusted probability of Team 1 win</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>matches[, SPI_diff <span class="sc">:</span><span class="er">=</span> spi1 <span class="sc">-</span> spi2]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>matches[, prob1_adj <span class="sc">:</span><span class="er">=</span> prob1 <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>probtie]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>matches[, <span class="st">`</span><span class="at">Team 1 Result</span><span class="st">`</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(score1 <span class="sc">&gt;</span> score2 <span class="sc">~</span> <span class="st">'Win'</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                                    score1 <span class="sc">==</span> score2 <span class="sc">~</span> <span class="st">'Draw'</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                                    score1 <span class="sc">&lt;</span> score2 <span class="sc">~</span> <span class="st">'Loss'</span>), </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'Loss'</span>, <span class="st">'Draw'</span>, <span class="st">'Win'</span>))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>       ]</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># find how many matches we know have incomplete "winner" information</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>n_incomplete <span class="ot">&lt;-</span> <span class="fu">nrow</span>( matches[probtie <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Team 1 Result</span><span class="st">`</span> <span class="sc">==</span> <span class="st">'Draw'</span>] )</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{n_incomplete} matches have incomplete result data'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>5 matches have incomplete result data</code></pre>
</div>
</div>
<p>We now create our figure of interest.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot figure</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(matches, <span class="fu">aes</span>(<span class="at">x =</span> SPI_diff, <span class="at">y =</span> prob1_adj, <span class="at">colour =</span> <span class="st">`</span><span class="at">Team 1 Result</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_nejm</span>() <span class="sc">+</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Team 1 SPI - Team 2 SPI'</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">'(Adjusted) Probability of Team 1 Win'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="reproduction_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The x-axis in the figure above is a function of both team’s <code>SPI</code>, which is ESPN’s <a href="https://fivethirtyeight.com/methodology/how-our-club-soccer-predictions-work/">Soccer Power Index</a>; an index originally designed by Nate Silver. The predictions appear to track pretty closely with the difference in team SPI, which makes sense (to me) given that Nate Silver created both <code>SPI</code> and FiveThirtyEight.</p>
<p>Just for fun, I wanted to see how FiveThirtyEight’s predictions performed relative to a naive function of <code>SPI</code>. I converted FiveThirtyEight’s probabilistic predictions into a categorical variable by choosing the maximum predicted probability; that is, if the probabilities of <code>Loss</code>, <code>Draw</code>, and <code>Win</code> were, say, <code>c(0.3, 0.2, 0.5)</code>, I would say that FiveThirtyEight predicted a win. If two of the results are given the same probability, this is always coded as a prediction of <code>Draw</code>.</p>
<p>I then made my own naive prediction function, in which the team with a higher <code>SPI</code> is predicted to win with probability 1. If the two teams are tied on <code>SPI</code>, I predict <code>Draw</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># map 538 forecasts to categorical prediction</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>matches[, max_prob <span class="sc">:</span><span class="er">=</span> <span class="fu">pmax</span>(prob1, prob2, probtie)]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>matches[, <span class="st">`</span><span class="at">Predicted Team 1 Result</span><span class="st">`</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(prob1 <span class="sc">==</span> max_prob <span class="sc">~</span> <span class="st">'Win'</span>, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                                                        prob2 <span class="sc">==</span> max_prob <span class="sc">~</span> <span class="st">'Loss'</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                                                        probtie <span class="sc">==</span> max_prob <span class="sc">~</span> <span class="st">'Draw'</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                                                        prob1 <span class="sc">==</span> prob2 <span class="sc">~</span> <span class="st">'Draw'</span>), </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'Loss'</span>, <span class="st">'Draw'</span>, <span class="st">'Win'</span>))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>       ]</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># map SPI to categorical prediction</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>matches[, <span class="st">`</span><span class="at">Naive Predicted Team 1 Result</span><span class="st">`</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(spi1 <span class="sc">&gt;</span> spi2 <span class="sc">~</span> <span class="st">'Win'</span>, </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>                                                              spi1 <span class="sc">==</span> spi2 <span class="sc">~</span> <span class="st">'Draw'</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>                                                              spi1 <span class="sc">&lt;</span> spi2 <span class="sc">~</span> <span class="st">'Loss'</span>), </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>                                                              <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'Loss'</span>, <span class="st">'Draw'</span>, <span class="st">'Win'</span>))</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>       ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We note that, after this categorical remapping, the FiveThirtyEight predictions are identical to those from my naive “model”. That is, in these data, every single match’s most likely outcome (according to the FiveThirtyEight predictions) is that the team with the larger SPI wins.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get agreement between 538 and naive predictions</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>fivethirtyeight_preds <span class="ot">&lt;-</span> matches[, <span class="st">`</span><span class="at">Predicted Team 1 Result</span><span class="st">`</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>naive_preds <span class="ot">&lt;-</span> matches[, <span class="st">`</span><span class="at">Naive Predicted Team 1 Result</span><span class="st">`</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>agreement <span class="ot">&lt;-</span> fivethirtyeight_preds <span class="sc">==</span> naive_preds</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'Predictions agree on {sum(agreement)} of {length(agreement)} matches'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Predictions agree on 64 of 64 matches</code></pre>
</div>
</div>
<p>As a final step, I wanted to check the performance of FiveThirtyEight’s probabilistic predictions against my naive binary predictions. I set up an <span class="math inline">\(\ell_1\)</span> loss function for each match, where FiveThirtyEight’s probabilistic predictions and my binary predictions would be compared against the true outcome of the match.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>l1_loss <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b) {</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(<span class="fu">abs</span>(a<span class="sc">-</span>b)))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># get l1 losses</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>n_match <span class="ot">&lt;-</span> <span class="fu">nrow</span>(matches)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>fivethirtyeight_l1_losses <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_match)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>naive_l1_losses <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_match)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_match) {</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    actual_y <span class="ot">&lt;-</span> <span class="fu">case_when</span>(matches[i, <span class="st">`</span><span class="at">Team 1 Result</span><span class="st">`</span>] <span class="sc">==</span> <span class="st">'Loss'</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                          matches[i, <span class="st">`</span><span class="at">Team 1 Result</span><span class="st">`</span>] <span class="sc">==</span> <span class="st">'Draw'</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                          matches[i, <span class="st">`</span><span class="at">Team 1 Result</span><span class="st">`</span>] <span class="sc">==</span> <span class="st">'Win'</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    fivethirtyeight_predicted_y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(matches[i, <span class="fu">c</span>(<span class="st">'prob2'</span>, <span class="st">'probtie'</span>, <span class="st">'prob1'</span>)])</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    naive_predicted_y <span class="ot">&lt;-</span> <span class="fu">case_when</span>(matches[i, <span class="st">`</span><span class="at">Naive Predicted Team 1 Result</span><span class="st">`</span>] <span class="sc">==</span> <span class="st">'Loss'</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                                   matches[i, <span class="st">`</span><span class="at">Naive Predicted Team 1 Result</span><span class="st">`</span>] <span class="sc">==</span> <span class="st">'Draw'</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                                   matches[i, <span class="st">`</span><span class="at">Naive Predicted Team 1 Result</span><span class="st">`</span>] <span class="sc">==</span> <span class="st">'Win'</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    fivethirtyeight_l1_losses[i] <span class="ot">&lt;-</span> <span class="fu">l1_loss</span>(actual_y, fivethirtyeight_predicted_y)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    naive_l1_losses[i] <span class="ot">&lt;-</span> <span class="fu">l1_loss</span>(actual_y, naive_predicted_y)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'Average l1 loss for FiveThirtyEight: {mean(fivethirtyeight_l1_losses)}</span><span class="sc">\n</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="st">            Average l1 loss for naive model: {mean(naive_l1_losses)}'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Average l1 loss for FiveThirtyEight: 1.1803546875

Average l1 loss for naive model: 0.9375</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># glue::glue('Average l1 loss for naive model: {mean(naive_l1_losses)}')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Somewhat surprisingly to me, the naive model had lower average <span class="math inline">\(\ell_1\)</span> loss than do FiveThirtyEight’s probabilistic predictions. Obviously this is a small sample, and this may not hold under other plausible loss functions. Moreover, perhaps these results can be explained by the 5 matches which we know have incorrect result data. We drop these and compute the losses again.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create data without incorrect results</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>incomplete_info_matches <span class="ot">&lt;-</span> matches[probtie <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Team 1 Result</span><span class="st">`</span> <span class="sc">==</span> <span class="st">'Draw'</span>]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>matches_correct <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(matches, incomplete_info_matches)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># get l1 losses</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>n_match <span class="ot">&lt;-</span> <span class="fu">nrow</span>(matches_correct)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>fivethirtyeight_l1_losses <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_match)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>naive_l1_losses <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_match)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_match) {</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    actual_y <span class="ot">&lt;-</span> <span class="fu">case_when</span>(matches_correct[i, <span class="st">`</span><span class="at">Team 1 Result</span><span class="st">`</span>] <span class="sc">==</span> <span class="st">'Loss'</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                          matches_correct[i, <span class="st">`</span><span class="at">Team 1 Result</span><span class="st">`</span>] <span class="sc">==</span> <span class="st">'Draw'</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                          matches_correct[i, <span class="st">`</span><span class="at">Team 1 Result</span><span class="st">`</span>] <span class="sc">==</span> <span class="st">'Win'</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    fivethirtyeight_predicted_y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(matches_correct[i, <span class="fu">c</span>(<span class="st">'prob2'</span>, <span class="st">'probtie'</span>, <span class="st">'prob1'</span>)])</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    naive_predicted_y <span class="ot">&lt;-</span> <span class="fu">case_when</span>(matches_correct[i, <span class="st">`</span><span class="at">Naive Predicted Team 1 Result</span><span class="st">`</span>] <span class="sc">==</span> <span class="st">'Loss'</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                                   matches_correct[i, <span class="st">`</span><span class="at">Naive Predicted Team 1 Result</span><span class="st">`</span>] <span class="sc">==</span> <span class="st">'Draw'</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>                                   matches_correct[i, <span class="st">`</span><span class="at">Naive Predicted Team 1 Result</span><span class="st">`</span>] <span class="sc">==</span> <span class="st">'Win'</span> <span class="sc">~</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    fivethirtyeight_l1_losses[i] <span class="ot">&lt;-</span> <span class="fu">l1_loss</span>(actual_y, fivethirtyeight_predicted_y)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    naive_l1_losses[i] <span class="ot">&lt;-</span> <span class="fu">l1_loss</span>(actual_y, naive_predicted_y)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'Average l1 loss for FiveThirtyEight: {mean(fivethirtyeight_l1_losses)}'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Average l1 loss for FiveThirtyEight: 1.11089322033898</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'Average l1 loss for naive model: {mean(naive_l1_losses)}'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Average l1 loss for naive model: 0.847457627118644</code></pre>
</div>
</div>
<p>We get qualitatively similar results here, in that our naive model still outperforms the probabilistic FiveThirtyEight predictions.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>